{"_path":"/dotnet/2020-08-16-concurrentdictionary","_dir":"dotnet","_draft":false,"_partial":false,"_locale":"","title":"ConcurrentDictionary并发字典","description":"ConcurrentDictionary主要用于要从多个线程（或异步任务）修改字典的情景中。如果来自单个线程，则可以根据需要使用尽可能多的代码使用标准Dictionary；）","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ConcurrentDictionary主要用于要从多个线程（或异步任务）修改字典的情景中。如果来自单个线程，则可以根据需要使用尽可能多的代码使用标准Dictionary；）"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"如果您查看ConcurrentDictionary上的方法，则会发现一些有趣的方法，例如TryAdd，TryGetValue，TryUpdate和TryRemove。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"例如，若使用普通的Dictionary类时可能会看到下面的代码"}]},{"type":"element","tag":"pre","props":{"code":"// There are better ways to do this... but we need an example ;)\nif (!dictionary.ContainsKey(id))\n    dictionary.Add(id, value);\n    \n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"// There are better ways to do this... but we need an example ;)\nif (!dictionary.ContainsKey(id))\n    dictionary.Add(id, value);\n    \n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"多线程中同时调用该段代码,并且使用相同的id来调用Add,它将引发异常。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"ConcurrentDictionary方法TryAdd为您处理该问题，并将返回true/false，告诉您是否已添加它（或该键是否已在字典中）。"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"因此，除非您在代码的多线程部分中进行工作，否则您可能仅可以使用标准的Dictionary类。"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:dotnet:2020-08-16-ConcurrentDictionary.md","_source":"content","_file":"dotnet/2020-08-16-ConcurrentDictionary.md","_extension":"md","date":"2020-08-16"}