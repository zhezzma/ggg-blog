{"_path":"/dotnet/2020-05-29-abp-start","_dir":"dotnet","_draft":false,"_partial":false,"_locale":"","title":"abp新建项目指南","description":"替换数据库为mysql替换mysql,Dothass.Blog.EntityFrameworkCore项目中<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.MySQL\" Version=\"2.8.0\" />\n删除之前的迁移目录修改连接字符串 项目Dothass.Blog.DbMigrator和Dothass.Blog.Web.. //详情请见https://www.connectionstrings.com/mysql/\n \"ConnectionStrings\": {\n    \"Default\": server=localhost","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"替换数据库为mysql"},"children":[{"type":"text","value":"替换数据库为mysql"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"替换mysql,Dothass.Blog.EntityFrameworkCore项目中"}]}]},{"type":"element","tag":"pre","props":{"code":"<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.MySQL\" Version=\"2.8.0\" />\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"<PackageReference Include=\"Volo.Abp.EntityFrameworkCore.MySQL\" Version=\"2.8.0\" />\n"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"删除之前的迁移目录"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"修改连接字符串 项目"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Dothass.Blog.DbMigrator"}]},{"type":"text","value":"和"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Dothass.Blog.Web"}]},{"type":"text","value":".."}]}]},{"type":"element","tag":"pre","props":{"code":" //详情请见https://www.connectionstrings.com/mysql/\n \"ConnectionStrings\": {\n    \"Default\": server=localhost;port=3306;database=dothass.blog;uid=root;password=123456\"\n },\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":" //详情请见https://www.connectionstrings.com/mysql/\n \"ConnectionStrings\": {\n    \"Default\": server=localhost;port=3306;database=dothass.blog;uid=root;password=123456\"\n },\n"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"生成新的迁移,nuget包管理器.默认项目设置为"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Dothass.Blog.EntityFrameworkCore.DbMigrations"}]}]}]},{"type":"element","tag":"pre","props":{"code":"Add-Migration Init\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"Add-Migration Init\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"相关链接: "},{"type":"element","tag":"a","props":{"href":"https://docs.abp.io/zh-Hans/abp/latest/Entity-Framework-Core-MySQL","rel":["nofollow"]},"children":[{"type":"text","value":"https://docs.abp.io/zh-Hans/abp/latest/Entity-Framework-Core-MySQL"}]}]},{"type":"element","tag":"h1","props":{"id":"初始化项目"},"children":[{"type":"text","value":"初始化项目"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"将三个项目copy到程序中.然后在web项目中添加依赖"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"typeof(AbpExtensionWebModule)"}]},{"type":"text","value":"即可"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"修改migrationservice,"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"DotHass.Blog.Domain"}]},{"type":"text","value":"项目下"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"BlogDbMigrationService"}]}]}]},{"type":"element","tag":"pre","props":{"code":"  private async Task SeedDataAsync(Tenant tenant = null)\n  {\n        Logger.LogInformation($\"Executing {(tenant == null ? \"host\" : tenant.Name + \" tenant\")} database seed...\");\n\n        //IdentityDataSeedContributor : IDataSeedContributor ---> IIdentityDataSeeder\n        //手动实例化上下文,来设置admin的email和密码..或者替换IIdentityDataSeeder的service\n        var seedContext = new DataSeedContext(tenant?.Id);\n        var configurationSection = _configuration.GetSection(\"Identity\");\n        seedContext.WithProperty(\"AdminEmail\", configurationSection[\"AdminEmail\"]);\n        seedContext.WithProperty(\"AdminPassword\", configurationSection[\"AdminPassword\"]);\n\n        //PermissionDataSeedContributor : IDataSeedContributor  --->IPermissionDataSeeder\n        //为amidn添加权限 -- 一般来说不用改什么,但是需要在BlogDbMigratorModule中引用你设置权限的模块依赖..否则找不到你添加的权限\n\n        await _dataSeeder.SeedAsync(seedContext);\n    }\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"  private async Task SeedDataAsync(Tenant tenant = null)\n  {\n        Logger.LogInformation($\"Executing {(tenant == null ? \"host\" : tenant.Name + \" tenant\")} database seed...\");\n\n        //IdentityDataSeedContributor : IDataSeedContributor ---> IIdentityDataSeeder\n        //手动实例化上下文,来设置admin的email和密码..或者替换IIdentityDataSeeder的service\n        var seedContext = new DataSeedContext(tenant?.Id);\n        var configurationSection = _configuration.GetSection(\"Identity\");\n        seedContext.WithProperty(\"AdminEmail\", configurationSection[\"AdminEmail\"]);\n        seedContext.WithProperty(\"AdminPassword\", configurationSection[\"AdminPassword\"]);\n\n        //PermissionDataSeedContributor : IDataSeedContributor  --->IPermissionDataSeeder\n        //为amidn添加权限 -- 一般来说不用改什么,但是需要在BlogDbMigratorModule中引用你设置权限的模块依赖..否则找不到你添加的权限\n\n        await _dataSeeder.SeedAsync(seedContext);\n    }\n"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"执行项目Dothass.Blog.DbMigrator初始化数据"}]}]},{"type":"element","tag":"h1","props":{"id":"关于客户端js"},"children":[{"type":"text","value":"关于客户端js"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"执行 yarn & gulp 将所有包都会将自己的资源复制到wwwroot/libs文件夹中. 否则一些模块例如博客的js时不会起作用的"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"content:dotnet:2020-05-29-abp-start.md","_source":"content","_file":"dotnet/2020-05-29-abp-start.md","_extension":"md","date":"2020-05-29"}